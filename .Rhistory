expss::val_lab(Mauritania_ea_2022$HHHEdu)
Mauritania_ea_2022 %>%
plot_frq(coord.flip =T,HHHEdu)
# ##HHHEdu n'existe pas sur Mauritania_pdm_2020
Mauritania_pdm_2020$HHHEdu <- as.factor(Mauritania_pdm_2020$HHHEdu)
# expss::val_lab(Mauritania_pdm_2020$HHHEdu)
#
expss::val_lab(Mauritania_pdm_2021$HHHEdu)
Mauritania_pdm_2021 <-
Mauritania_pdm_2021 %>% dplyr::mutate(HHHEdu = dplyr::recode(HHHEdu,"1"=1,"2"=2,"3"=2,"4"=3,"5"=4,"6"=5))
Mauritania_pdm_2021$HHHEdu <- labelled::labelled(Mauritania_pdm_2021$HHHEdu, c(Aucune = 1, `Alphabétisé ou Coranique` = 2, Primaire= 3,Secondaire=4, Superieur=5))
expss::val_lab(Mauritania_pdm_2021$HHHEdu)
Mauritania_pdm_2021 %>%
plot_frq(coord.flip =T,HHHEdu)
Mauritania_ea_2020 <- Mauritania_ea_2020 %>% mutate(HHSize= HHSize23M+HHSize59M+HHSize65AboveM)
Mauritania_baseline_2018$HHSize <- as.numeric(Mauritania_baseline_2018$HHSize)
Mauritania_ea_2019$HHSize <- as.numeric(Mauritania_ea_2019$HHSize)
Mauritania_ea_2020$HHSize <- as.numeric(Mauritania_ea_2020$HHSize)
Mauritania_ea_2021$HHSize <- as.numeric(Mauritania_ea_2021$HHSize)
Mauritania_ea_2022$HHSize <- as.numeric(Mauritania_ea_2022$HHSize)
Mauritania_pdm_2020$HHSize <- as.numeric(Mauritania_pdm_2020$HHSize)
Mauritania_pdm_2021$HHSize <- as.numeric(Mauritania_pdm_2021$HHSize)
# Monogame    Polygame     Divorcé(e)   Veuf/Veuve    Célibataire
#   1           2           3              4           5
expss::val_lab(Mauritania_baseline_2018$HHHMatrimonial)
Mauritania_baseline_2018 <-
Mauritania_baseline_2018 %>% dplyr::mutate(HHHMatrimonial = dplyr::recode(HHHMatrimonial,"1"=1,"2"=2,"3"=3,"4"=3,"5"=4,"6"=5))#QUESTION : marié mais séparé=divorcé ?
Mauritania_baseline_2018$HHHMatrimonial <- labelled::labelled(Mauritania_baseline_2018$HHHMatrimonial, c(Monogame = 1, Polygame = 2, `Divorcé(e)`= 3,`Veuf/Veuve`=4, `Célibataire`=5))
expss::val_lab(Mauritania_baseline_2018$HHHMatrimonial)
Mauritania_baseline_2018 %>%
plot_frq(coord.flip =T,HHHMatrimonial)
#2019
expss::val_lab(Mauritania_ea_2019$HHHMatrimonial)
#n'existe pas en 2019
Mauritania_ea_2019$HHHMatrimonial<- as.factor(Mauritania_ea_2019$HHHMatrimonial)
expss::val_lab(Mauritania_ea_2020$HHHMatrimonial)
#n'existe pas en 2020
##
Mauritania_ea_2020$HHHMatrimonial<- as.factor(Mauritania_ea_2020$HHHMatrimonial)
expss::val_lab(Mauritania_ea_2021$HHHMatrimonial)
Mauritania_ea_2021 <-
Mauritania_ea_2021 %>% dplyr::mutate(HHHMatrimonial = dplyr::recode(HHHMatrimonial,"1"=1,"2"=2,"3"=3,"4"=3,"5"=4,"6"=5))#QUESTION : marié mais séparé=divorcé ?
Mauritania_ea_2021$HHHMatrimonial <- labelled::labelled(Mauritania_ea_2021$HHHMatrimonial, c(Monogame = 1, Polygame = 2, `Divorcé(e)`= 3,`Veuf/Veuve`=4, `Célibataire`=5))
expss::val_lab(Mauritania_ea_2021$HHHMatrimonial)
Mauritania_ea_2021 %>%
plot_frq(coord.flip =T,HHHMatrimonial)
expss::val_lab(Mauritania_ea_2022$HHHMatrimonial)
Mauritania_ea_2022$HHHMatrimonial<- as.factor(Mauritania_ea_2022$HHHMatrimonial)
#n'existe pas en 2022
expss::val_lab(Mauritania_pdm_2020$HHHMatrimonial)
#n'existe pas en 2020
##
Mauritania_pdm_2020$HHHMatrimonial<-as.factor(Mauritania_pdm_2020$HHHMatrimonial)
expss::val_lab(Mauritania_pdm_2021$HHHMatrimonial)
Mauritania_pdm_2021<- Mauritania_pdm_2021 %>% dplyr::mutate(HHHMatrimonial = dplyr::recode(HHHMatrimonial,"1"=1,"2"=2,"3"=3,"4"=3,"5"=4,"6"=5))#QUESTION : marié mais séparé=divorcé ?
Mauritania_pdm_2021$HHHMatrimonial <- labelled::labelled(Mauritania_pdm_2021$HHHMatrimonial, c(Monogame = 1, Polygame = 2, `Divorcé(e)`= 3,`Veuf/Veuve`=4, `Célibataire`=5))
expss::val_lab(Mauritania_pdm_2021$HHHMatrimonial)
Mauritania_pdm_2021 %>%
plot_frq(coord.flip =T,HHHMatrimonial)
# VAriable non disponible pour toutes les bases
expss::val_lab(Mauritania_baseline_2018$HHSourceIncome)
expss::val_lab(Mauritania_ea_2019$HHSourceIncome)
expss::val_lab(Mauritania_ea_2020$HHSourceIncome)
expss::val_lab(Mauritania_ea_2021$HHSourceIncome)
expss::val_lab(Mauritania_ea_2022$HHSourceIncome)
expss::val_lab(Mauritania_pdm_2020$HHSourceIncome)
expss::val_lab(Mauritania_pdm_2021$HHSourceIncome)
Mauritania_pdm_2020$DebutAssistance <- as.Date(ifelse(as.Date(Mauritania_pdm_2020$DebutAssistance) == "2107-07-29", as.Date("2007-07-29"), as.Date(Mauritania_pdm_2020$DebutAssistance)),origin = "1970-01-01")
Mauritania_ea_2020$DebutAssistance <- as.Date(ifelse(as.Date(Mauritania_ea_2020$DebutAssistance) == "2108-12-31", as.Date("2008-12-31"), as.Date(Mauritania_ea_2020$DebutAssistance)),origin = "1970-01-01")
Mauritania_pdm_2021$DebutAssistance <- as.Date(ifelse(as.Date(Mauritania_pdm_2021$DebutAssistance) == "1986-12-01", as.Date("2000-12-01"), as.Date(Mauritania_pdm_2021$DebutAssistance)),origin = "1970-01-01")
Mauritania_ea_2021$DebutAssistance<-as.Date(Mauritania_ea_2021$DebutAssistance)
Mauritania_ea_2022$DebutAssistance<-as.Date(Mauritania_ea_2022$DebutAssistance)
Mauritania_pdm_2020$DebutAssistance<-as.Date(Mauritania_pdm_2020$DebutAssistance)
Mauritania_baseline_2018$DebutAssistance<-as.Date(Mauritania_baseline_2018$DebutAssistance) #NA
Mauritania_ea_2019$DebutAssistance<-as.Date(Mauritania_ea_2019$DebutAssistance)
Mauritania_ea_2020$DebutAssistance<-as.Date(Mauritania_ea_2020$DebutAssistance)
Mauritania_pdm_2021$DebutAssistance<-as.Date(Mauritania_pdm_2021$DebutAssistance)
expss::val_lab(Mauritania_baseline_2018$DateDerniereAssist)
Mauritania_baseline_2018$DateDerniereAssist <- as.factor(Mauritania_baseline_2018$DateDerniereAssist)
#2019
Mauritania_ea_2019 <-
Mauritania_ea_2019 %>% dplyr::mutate_at(c("DateDerniereAssist"),recode,"1"=1,"2"=2,"3"=3,"other"=NA_real_)
Mauritania_ea_2019$DateDerniereAssist <- labelled::labelled(Mauritania_ea_2019$DateDerniereAssist, c(`moins d’une semaine` = 1, `entre 1 et 3 semaines` = 2,`plus de 3 semaines`=3))
Mauritania_ea_2019 %>%
plot_frq(coord.flip =T,DateDerniereAssist,show.na =T)
#ea_2020
Mauritania_ea_2020 <-
Mauritania_ea_2020 %>% dplyr::mutate_at(c("DateDerniereAssist"),recode,"1"=1,"2"=2,"3"=3,"other"=NA_real_)
Mauritania_ea_2020$DateDerniereAssist <- labelled::labelled(Mauritania_ea_2020$DateDerniereAssist, c(`moins d’une semaine` = 1, `entre 1 et 3 semaines` = 2,`plus de 3 semaines`=3))
Mauritania_ea_2020 %>%
plot_frq(coord.flip =T,DateDerniereAssist,show.na =T)
#ea_2021
expss::val_lab(Mauritania_ea_2021$DateDerniereAssist)
Mauritania_ea_2021 <-
Mauritania_ea_2021 %>% dplyr::mutate_at(c("DateDerniereAssist"),recode,"1"=1,"2"=2,"3"=3,"other"=NA_real_,.default=NA_real_)
Mauritania_ea_2021$DateDerniereAssist <- labelled::labelled(Mauritania_ea_2021$DateDerniereAssist, c(`moins d’une semaine` = 1, `entre 1 et 3 semaines` = 2,`plus de 3 semaines`=3))
Mauritania_ea_2021 %>%
plot_frq(coord.flip =T,DateDerniereAssist,show.na =T)
#ea_2022
expss::val_lab(Mauritania_ea_2022$DateDerniereAssist)
Mauritania_ea_2022 <-
Mauritania_ea_2022 %>% dplyr::mutate_at(c("DateDerniereAssist"),recode,"1"=1,"2"=2,"3"=3,"other"=NA_real_,.default=NA_real_)
Mauritania_ea_2022$DateDerniereAssist <- labelled::labelled(Mauritania_ea_2022$DateDerniereAssist, c(`moins d’une semaine` = 1, `entre 1 et 3 semaines` = 2,`plus de 3 semaines`=3))
Mauritania_ea_2022 %>%
plot_frq(coord.flip =T,DateDerniereAssist,show.na =T)
#pdm_2020
expss::val_lab(Mauritania_pdm_2020$DateDerniereAssist)
Mauritania_pdm_2020 <-
Mauritania_pdm_2020 %>% dplyr::mutate_at(c("DateDerniereAssist"),recode,"1"=1,"2"=2,"3"=3)
Mauritania_pdm_2020$DateDerniereAssist <- labelled::labelled(Mauritania_pdm_2020$DateDerniereAssist, c(`moins d’une semaine` = 1, `entre 1 et 3 semaines` = 2,`plus de 3 semaines`=3))
Mauritania_pdm_2020 %>%
plot_frq(coord.flip =T,DateDerniereAssist,show.na =T)
#pdm_2021
expss::val_lab(Mauritania_pdm_2021$DateDerniereAssist)
Mauritania_pdm_2021 <-
Mauritania_pdm_2021 %>% dplyr::mutate_at(c("DateDerniereAssist"),recode,"1"=1,"2"=2,"3"=3,"other"=NA_real_,.default=NA_real_)
Mauritania_pdm_2021$DateDerniereAssist <- labelled::labelled(Mauritania_pdm_2021$DateDerniereAssist, c(`moins d’une semaine` = 1, `entre 1 et 3 semaines` = 2,`plus de 3 semaines`=3))
Mauritania_pdm_2021 %>%
plot_frq(coord.flip =T,DateDerniereAssist,show.na =T)
var_type_assistance = c("BanqueCerealiere",
"VivreContreTravail",
"ArgentContreTravail",
"DistribVivresSoudure",
"DistribArgentSoudure",
"BoursesAdo",
"BlanketFeedingChildren",
"BlanketFeedingWomen",
"MAMChildren",
"MASChildren",
"MAMPLWomen",
"FARNcommunaut",
"FormationRenfCapacite",
"CashTransfert",
"CantineScolaire"
)
#1=Oui PAM 2=Oui, Autre 3=NSP
# La variable n'est pas disponible sur 2018
Mauritania_baseline_2018<- Mauritania_baseline_2018%>% mutate_at(var_type_assistance,as.factor)
# Nous avant transformer la modalité Non en  NA
expss::val_lab(Mauritania_ea_2019$BanqueCerealiere)
Mauritania_ea_2019 <- Mauritania_ea_2019 %>%
dplyr::mutate(across(var_type_assistance,
~recode(.,
"1" = 1,
"2" = NA_real_,
"3" = 3
)
)
)
Mauritania_ea_2019 <- Mauritania_ea_2019 %>%
dplyr::mutate(across(var_type_assistance,
~labelled(., labels = c(
"Oui, PAM" = 1,
"NSP" = 3,
" Oui, Autre" = 2
)
)
)
)
Mauritania_ea_2019 %>%
plot_frq(coord.flip =T,BanqueCerealiere,show.na =T)
#2020
expss::val_lab(Mauritania_ea_2020$BanqueCerealiere)
Mauritania_ea_2020 <- Mauritania_ea_2020 %>%
dplyr::mutate(across(var_type_assistance,
~recode(.,
"1" = 1,
"2" = NA_real_,
"3" = 3
)
)
)
Mauritania_ea_2020 <- Mauritania_ea_2020 %>%
dplyr::mutate(across(var_type_assistance,
~labelled(., labels = c(
"Oui, PAM" = 1,
"NSP" = 3,
" Oui, Autre" = 2
)
)
)
)
Mauritania_ea_2020 %>%
plot_frq(coord.flip =T,BanqueCerealiere,show.na =T)
#pdm 2020
expss::val_lab(Mauritania_pdm_2020$BanqueCerealiere)
Mauritania_pdm_2020 <- Mauritania_pdm_2020 %>%
dplyr::mutate(across(var_type_assistance,
~recode(.,
"1" = 1,
"2" = NA_real_,
"3" = 3
)
)
)
Mauritania_pdm_2020 <- Mauritania_pdm_2020 %>%
dplyr::mutate(across(var_type_assistance,
~labelled(., labels = c(
"Oui, PAM" = 1,
"NSP" = 3,
" Oui, Autre" = 2
)
)
)
)
Mauritania_pdm_2020 %>%
plot_frq(coord.flip =T,BanqueCerealiere,show.na =T)
#2021
expss::val_lab(Mauritania_ea_2021$BanqueCerealiere)
Mauritania_ea_2021 <- Mauritania_ea_2021 %>%
dplyr::mutate(across(var_type_assistance,
~recode(.,
"1" = 1,
"4" = NA_real_,
"3" = 3,
"2"=2,
)
)
)
Mauritania_ea_2021 <- Mauritania_ea_2021 %>%
dplyr::mutate(across(var_type_assistance,
~labelled(., labels = c(
"Oui, PAM" = 1,
"NSP" = 3,
" Oui, Autre" = 2
)
)
)
)
Mauritania_ea_2021 %>%
plot_frq(coord.flip =T,BanqueCerealiere,show.na =T)
#pdm 2021
expss::val_lab(Mauritania_pdm_2021$BanqueCerealiere)
Mauritania_pdm_2021 <- Mauritania_pdm_2021 %>%
dplyr::mutate(across(var_type_assistance,
~recode(.,
"1" = 1,
"4" = NA_real_,
"3" = 3,
"2"=2,
)
)
)
Mauritania_pdm_2021 <- Mauritania_pdm_2021 %>%
dplyr::mutate(across(var_type_assistance,
~labelled(., labels = c(
"Oui, PAM" = 1,
"NSP" = 3,
" Oui, Autre" = 2
)
)
)
)
Mauritania_pdm_2021 %>%
plot_frq(coord.flip =T,BanqueCerealiere,show.na =T)
#2022
expss::val_lab(Mauritania_ea_2022$BanqueCerealiere)
Mauritania_ea_2022 <- Mauritania_ea_2022 %>%
dplyr::mutate(across(var_type_assistance,
~recode(.,
"1" = 1,
"4" = NA_real_,
"3" = 3,
"2"=2,
)
)
)
Mauritania_ea_2022 <- Mauritania_ea_2022 %>%
dplyr::mutate(across(var_type_assistance,
~labelled(., labels = c(
"Oui, PAM" = 1,
"NSP" = 3,
" Oui, Autre" = 2
)
)
)
)
expss::val_lab(Mauritania_ea_2022$BanqueCerealiere)
Mauritania_ea_2022 %>%
plot_frq(coord.flip =T,BanqueCerealiere,show.na =T)
expss::val_lab(Mauritania_baseline_2018$AutreTransferts)
# Mauritania_baseline_2018 %>%
#  plot_frq(coord.flip =T,AutreTransferts)
Mauritania_baseline_2018$AutreTransferts<- as.factor(Mauritania_baseline_2018$AutreTransferts)
#View labels
expss::val_lab(Mauritania_ea_2019$AutreTransferts)
#Mauritania_ea_2019 %>%
#  plot_frq(coord.flip =T,AutreTransferts)
Mauritania_ea_2019$AutreTransferts<- dplyr::recode(Mauritania_ea_2019$AutreTransferts, "3" = 3, "2"=2,"other" = NA_real_)
Mauritania_ea_2019$AutreTransferts <- labelled::labelled(Mauritania_ea_2019$AutreTransferts, c("Oui, PAM" = 1, "Oui, Autre" = 2,"Ne Sait Pas"=3,"Non"=4))
#Check labels
expss::val_lab(Mauritania_ea_2019$AutreTransferts)
Mauritania_ea_2019 %>%
plot_frq(coord.flip =T,AutreTransferts)
#View labels
expss::val_lab(Mauritania_ea_2020$AutreTransferts)
Mauritania_ea_2020 %>%
plot_frq(coord.flip =T,AutreTransferts)
Mauritania_ea_2020$AutreTransferts<- dplyr::recode(Mauritania_ea_2020$AutreTransferts,.default = NA_real_)
Mauritania_ea_2020$AutreTransferts <- labelled::labelled(Mauritania_ea_2020$AutreTransferts, c("Oui, PAM" = 1, "Oui, Autre" = 2,"Ne Sait Pas"=3,"Non"=4))
#View labels
expss::val_lab(Mauritania_ea_2021$AutreTransferts)
Mauritania_ea_2021 %>%
plot_frq(coord.flip =T,AutreTransferts)
Mauritania_ea_2021$AutreTransferts<- dplyr::recode(Mauritania_ea_2021$AutreTransferts, "1"=1,"3" = 3, "2"=2,"4" =4)
Mauritania_ea_2021$AutreTransferts <- labelled::labelled(Mauritania_ea_2021$AutreTransferts, c("Oui, PAM" = 1, "Oui, Autre" = 2,"Ne Sait Pas"=3,"Non"=4))
#Check labels
expss::val_lab(Mauritania_ea_2021$AutreTransferts)
Mauritania_ea_2021 %>%
plot_frq(coord.flip =T,AutreTransferts)
#View labels
expss::val_lab(Mauritania_ea_2022$AutreTransferts)
Mauritania_ea_2022$AutreTransferts<- dplyr::recode(Mauritania_ea_2022$AutreTransferts, "1"=1,"3" = 3, "2"=2,"4" =4)
Mauritania_ea_2022$AutreTransferts <- labelled::labelled(Mauritania_ea_2022$AutreTransferts, c("Oui, PAM" = 1, "Oui, Autre" = 2,"Ne Sait Pas"=3,"Non"=4))
#Check labels
expss::val_lab(Mauritania_ea_2022$AutreTransferts)
Mauritania_ea_2022 %>%
plot_frq(coord.flip =T,AutreTransferts)
#View labels NULL
expss::val_lab(Mauritania_pdm_2020$AutreTransferts)
Mauritania_pdm_2020 %>%
plot_frq(coord.flip =T,AutreTransferts)
Mauritania_pdm_2020$AutreTransferts<- dplyr::recode(Mauritania_pdm_2020$AutreTransferts, "1"=1,"3" = 3, "2"=2,"other" =NA_real_)
Mauritania_pdm_2020$AutreTransferts <- labelled::labelled(Mauritania_pdm_2020$AutreTransferts, c("Oui, PAM" = 1, "Oui, Autre" = 2,"Ne Sait Pas"=3,"Non"=4))
#Check labels
expss::val_lab(Mauritania_pdm_2020$AutreTransferts)
Mauritania_pdm_2020 %>%
plot_frq(coord.flip =T,AutreTransferts)
#View labels
expss::val_lab(Mauritania_pdm_2021$AutreTransferts)
Mauritania_pdm_2021 %>%
plot_frq(coord.flip =T,AutreTransferts)
Mauritania_pdm_2021$AutreTransferts<- dplyr::recode(Mauritania_pdm_2021$AutreTransferts, "1"=1,"3" = 3, "4"=4)
Mauritania_pdm_2021$AutreTransferts <- labelled::labelled(Mauritania_pdm_2021$AutreTransferts, c("Oui, PAM" = 1, "Oui, Autre" = 2,"Ne Sait Pas"=3,"Non"=4))
#Check labels
expss::val_lab(Mauritania_pdm_2021$AutreTransferts)
Mauritania_pdm_2021 %>%
plot_frq(coord.flip =T,AutreTransferts)
Mauritania_baseline_2018 <- labelled::to_factor(Mauritania_baseline_2018)
Mauritania_ea_2019 <- labelled::to_factor(Mauritania_ea_2019)
Mauritania_ea_2020 <- labelled::to_factor(Mauritania_ea_2020)
Mauritania_ea_2021 <- labelled::to_factor(Mauritania_ea_2021)
Mauritania_ea_2022 <- labelled::to_factor(Mauritania_ea_2022)
Mauritania_pdm_2020 <- labelled::to_factor(Mauritania_pdm_2020)
Mauritania_pdm_2021 <- labelled::to_factor(Mauritania_pdm_2021)
WFP_Mauritania<-plyr::rbind.fill(Mauritania_baseline_2018,
Mauritania_ea_2019,
Mauritania_ea_2020,
Mauritania_ea_2021,
Mauritania_ea_2022,
Mauritania_pdm_2020,
Mauritania_pdm_2021)
WFP_Mauritania$HHHSex <-  labelled::labelled (WFP_Mauritania$HHHSex, labels=c(Femme = 0, Homme = 1))
WFP_Mauritania$MigrationEmploi <- labelled::labelled(WFP_Mauritania$MigrationEmploi, c(`Non` = 0, `Oui` = 1 ))
WFP_Mauritania$RelationWith_HHH<- as_factor(WFP_Mauritania$RelationWith_HHH)
WFP_Mauritania$RelationWith_HHH <- labelled::labelled(WFP_Mauritania$RelationWith_HHH,
c(`Chef de menage` = 1, `Pere` = 2,`Mere`=3,
`Grands Parents`=4,
`Epoux`=5 ,
`Epouse`=6,
`Enfant`=7,
`Fils`=8,
`Fille`=9,
`Beau-père`=10,
`Belle-mère`=11,
`Oncle`=12,
`Tante`=13,
`Cousin`=14,
`Cousine`=15,
`Neveu`=16,
` Nièce`=17,
`Autre personne en charge`=18)
)
GRA = c("GraviteImpactRevenus","GraviteImpactSAN")
WFP_Mauritania <- WFP_Mauritania %>%
dplyr::mutate(across(GRA,
~labelled(., labels = c("Pas d'impact" = 1, "Légère diminution" = 2,"Forte diminution"=3,"Pire que jamais"=4,"Ne sait pas"=888,"Refus"=8888)
)
)
)
abi_variables = WFP_Mauritania %>% dplyr::select(gtsummary::starts_with("ABI")) %>% names()
#
abi_variables <- abi_variables[! abi_variables %in% c('ABISexparticipant')]
WFP_Mauritania <- WFP_Mauritania %>%
mutate_at(abi_variables, as.numeric)
WFP_Mauritania <- WFP_Mauritania %>%
dplyr::mutate(across(abi_variables,
~labelled(., labels = c(
`Non` = 0,
`Oui` = 1,
`Ne sait pas` = 888
)
)
)
)
WFP_Mauritania$ABISexparticipant<- as.numeric(WFP_Mauritania$ABISexparticipant)
WFP_Mauritania$ABISexparticipant <- labelled::labelled(WFP_Mauritania$ABISexparticipant, c(Femme = 0, Homme = 1))
WFP_Mauritania.sub<- WFP_Mauritania  %>% dplyr::select(ID,adm0_ocha,ADMIN0Name,adm1_ocha,ADMIN1Name,adm2_ocha,ADMIN2Name,SURVEY,YEAR,SvyDatePDM,HHHSex ,HHHAge, HHHEdu,everything())
WFP_Mauritania <- copy_labels(WFP_Mauritania.sub, WFP_Mauritania)
#
# df = WFP_Mauritania %>% dplyr::select(abi_variables)
# df <- labelled::to_factor(df)
#
# haven::write_dta(df,"df.dta")
var_to_drop = c("RESPConsent",
"ADMIN3Name",
"RESPAge",
"RESPSex",
#"RelationWith_HHH",
"HHHMainActivity",
#"HHHMatrimonial",
"HHSourceIncome"
)
WFP_Mauritania <- WFP_Mauritania  %>% dplyr::select(-var_to_drop)
# Lire les métadonnées d'harmonisation
Mauritania_Harmonization_variables_labels <- read_excel(paste0(dir_input_data, "/MRT_Harmonization.xlsx"),
sheet = "variables_labels")
# Identifier les variables communes
variable_to_labels <- intersect(Mauritania_Harmonization_variables_labels$Variable_Name, names(WFP_Mauritania))
# Créer un tribble de métadonnées
WFP_Mauritania.sub_metadata <- tibble(
variable = Mauritania_Harmonization_variables_labels$Variable_Name,
variable_label = Mauritania_Harmonization_variables_labels$Variable_Label
)
# Convertir en vecteur nommé
WFP_Mauritania.sub_labels <- deframe(WFP_Mauritania.sub_metadata)
# Sélectionner le sous-ensemble de données
df <- WFP_Mauritania |> dplyr::select(variable_to_labels)
# Filtrer les étiquettes pour ne garder que celles dont les variables existent dans df
valid_labels <- WFP_Mauritania.sub_labels[names(WFP_Mauritania.sub_labels) %in% names(df)]
# Appliquer les étiquettes filtrées aux variables de df
WFP_Mauritania.sub_labelled <- df |> set_variable_labels(!!!valid_labels)
#WFP_Mauritania.sub_labelled
#View(WFP_Mauritania.sub_labelled)
#WFP_Mauritania <- labelled::to_factor(WFP_Mauritania)
# WFP_Mauritania_dictionary <- WFP_Mauritania |>
#   generate_dictionary()
# WFP_Mauritania_dictionary |>
#   knitr::kable()
#devtools::install_github("pcctc/croquet")
library(croquet)
library(openxlsx)
wb <- createWorkbook()
add_labelled_sheet(WFP_Mauritania)
saveWorkbook(wb, "WFP_Mauritania.xlsx",overwrite = TRUE)
# Lire les métadonnées d'harmonisation
Mauritania_Harmonization_variables_labels <- read_excel(paste0(dir_input_data, "/MRT_Harmonization.xlsx"),
sheet = "variables_labels")
# Identifier les variables communes
variable_to_labels <- intersect(Mauritania_Harmonization_variables_labels$Variable_Name, names(WFP_Mauritania))
# Créer un tribble de métadonnées
WFP_Mauritania.sub_metadata <- tibble(
variable = Mauritania_Harmonization_variables_labels$Variable_Name,
variable_label = Mauritania_Harmonization_variables_labels$Variable_Label
)
# Convertir en vecteur nommé
WFP_Mauritania.sub_labels <- deframe(WFP_Mauritania.sub_metadata)
# Sélectionner le sous-ensemble de données
df <- WFP_Mauritania |> dplyr::select(variable_to_labels)
# Filtrer les étiquettes pour ne garder que celles dont les variables existent dans df
valid_labels <- WFP_Mauritania.sub_labels[names(WFP_Mauritania.sub_labels) %in% names(df)]
# Appliquer les étiquettes filtrées aux variables de df
WFP_Mauritania.sub_labelled <- df |> set_variable_labels(!!!valid_labels)
# Lire les métadonnées d'harmonisation
Mauritania_Harmonization_variables_labels <- read_excel(paste0(dir_input_data, "/MRT_Harmonization.xlsx"),
sheet = "variables_labels")
# Identifier les variables communes
variable_to_labels <- intersect(Mauritania_Harmonization_variables_labels$Variable_Name, names(WFP_Mauritania))
# Créer un tribble de métadonnées
WFP_Mauritania.sub_metadata <- tibble(
variable = Mauritania_Harmonization_variables_labels$Variable_Name,
variable_label = Mauritania_Harmonization_variables_labels$Variable_Label
)
# Convertir en vecteur nommé
WFP_Mauritania.sub_labels <- deframe(WFP_Mauritania.sub_metadata)
# Sélectionner le sous-ensemble de données
df <- WFP_Mauritania |> dplyr::select(variable_to_labels)
# Filtrer les étiquettes pour ne garder que celles dont les variables existent dans df
valid_labels <- WFP_Mauritania.sub_labels[names(WFP_Mauritania.sub_labels) %in% names(df)]
# Appliquer les étiquettes filtrées aux variables de df
WFP_Mauritania.sub_labelled <- df |> set_variable_labels(!!!valid_labels)
# Lire les métadonnées d'harmonisation
Mauritania_Harmonization_variables_labels <- read_excel(paste0(dir_input_data, "/MRT_Harmonization.xlsx"),
sheet = "variables_labels")
# Identifier les variables communes
variable_to_labels <- intersect(Mauritania_Harmonization_variables_labels$Variable_Name, names(WFP_Mauritania))
# Créer un tribble de métadonnées
WFP_Mauritania.sub_metadata <- tibble(
variable = Mauritania_Harmonization_variables_labels$Variable_Name,
variable_label = Mauritania_Harmonization_variables_labels$Variable_Label
)
# Convertir en vecteur nommé
WFP_Mauritania.sub_labels <- deframe(WFP_Mauritania.sub_metadata)
# Sélectionner le sous-ensemble de données
df <- WFP_Mauritania |> dplyr::select(variable_to_labels)
# Filtrer les étiquettes pour ne garder que celles dont les variables existent dans df
valid_labels <- WFP_Mauritania.sub_labels[names(WFP_Mauritania.sub_labels) %in% names(df)]
# Appliquer les étiquettes filtrées aux variables de df
WFP_Mauritania.sub_labelled <- df |> set_variable_labels(!!!valid_labels)
haven::write_dta(WFP_Mauritania.sub_labelled,"WFP_Mauritania.dta")
#WFP_Mauritania <- labelled::to_factor(WFP_Mauritania)
WFP_Mauritania$YEAR <-as.numeric(WFP_Mauritania)
#WFP_Mauritania <- labelled::to_factor(WFP_Mauritania)
WFP_Mauritania$YEAR <-as.numeric(WFP_Mauritania$YEAR)
haven::write_dta(WFP_Mauritania.sub_labelled,"WFP_Mauritania.dta")
class(WFP_Mauritania$YEAR)
#WFP_Mauritania <- labelled::to_factor(WFP_Mauritania)
WFP_Mauritania$YEAR <-year(ymd(paste0(WFP_Mauritania$YEAR, "-01-01")))
haven::write_dta(WFP_Mauritania.sub_labelled,"WFP_Mauritania.dta")
#WFP_Mauritania <- labelled::to_factor(WFP_Mauritania)
WFP_Mauritania.sub_labelled$YEAR <-year(ymd(paste0(WFP_Mauritania.sub_labelled$YEAR, "-01-01")))
haven::write_dta(WFP_Mauritania.sub_labelled,"WFP_Mauritania.dta")
